Code is really messy but idc
